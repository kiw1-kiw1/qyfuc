<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Malla Química y Farmacia</title>
  <style>
    body {
      font-family: sans-serif;
      background: #f9f9ff;
      padding: 2em;
    }
    h1 {
      color: #4a148c;
    }
    .vista-toggle {
      margin-bottom: 1em;
    }
    .malla {
      display: flex;
      gap: 1em;
      overflow-x: auto;
    }
    .vertical .malla {
      flex-direction: column;
    }
    .semestre {
      background: #f3e5f5;
      border: 2px solid #ce93d8;
      border-radius: 12px;
      padding: 1em;
      min-width: 220px;
    }
    .semestre h2 {
      text-align: center;
      color: #6a1b9a;
    }
    .curso {
      margin: 5px 0;
      padding: 8px 12px;
      border: 2px solid #ba68c8;
      border-radius: 8px;
      background: white;
      cursor: pointer;
      transition: 0.2s;
    }
    .curso:hover {
      background: #f8e8ff;
    }
    .aprobado {
      background: #d1c4e9;
      border-color: #6a1b9a;
    }
    .curso.locked {
      opacity: 0.5;
      cursor: not-allowed;
      background-color: #ffe6f0;
      border-color: #ff8a8a;
    }
    button {
      padding: 8px 16px;
      background-color: #ab47bc;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      margin-bottom: 1em;
    }
    button:hover {
      background-color: #9c27b0;
    }
  </style>
</head>
<body class="horizontal">
  <h1>Malla Química y Farmacia</h1>
  <div class="vista-toggle">
    <button onclick="alternarVista()">Cambiar vista</button>
  </div>
  <div class="malla">
    <!-- Los semestres se insertarán con JavaScript -->
  </div>

  <script>
    const cursos = [
      { nombre: "Química General I", id: "quimicaI", semestre: 1 },
      { nombre: "Introducción a las ciencias farmacéuticas", id: "introFarmaceuticas", semestre: 1 },
      { nombre: "El mundo de los medicamentos", id: "medicamentos", semestre: 1 },
      { nombre: "Laboratorio de Química General", id: "labQuimicaI", semestre: 1 },
      { nombre: "Precálculo", id: "precalculo", semestre: 1 },
      { nombre: "Filosofía ¿Para qué?", id: "filosofia", semestre: 1 },

      { nombre: "Química General II", id: "quimicaII", semestre: 2, prereqs: ["quimicaI"] },
      { nombre: "Cálculo I", id: "calculoI", semestre: 2, prereqs: ["precalculo"] },
      { nombre: "Física para ciencias", id: "fisica", semestre: 2 },
      { nombre: "Electivo Formación General", id: "electivo1", semestre: 2 },
      { nombre: "Electivo Formación General", id: "electivo2", semestre: 2 },

      { nombre: "Química Orgánica I", id: "organicaI", semestre: 3, prereqs: ["quimicaII"] },
      { nombre: "Estadística para Química y Farmacia", id: "estadistica", semestre: 3, prereqs: ["calculoI"] },
      { nombre: "Biología de la célula", id: "biocelular", semestre: 3 },
      { nombre: "Botánica y Farmacognosia", id: "farmacognosia", semestre: 3, prereqs: ["quimicaII"] },
      { nombre: "Electivo Formación General", id: "electivo3", semestre: 3 },

      { nombre: "Química Orgánica II", id: "organicaII", semestre: 4, prereqs: ["organicaI"] },
      { nombre: "Química Analítica", id: "analitica", semestre: 4, prereqs: ["quimicaII", "estadistica"] },
      { nombre: "Fisiología", id: "fisiologia", semestre: 4, prereqs: ["biocelular"] },
      { nombre: "Electivo Formación General", id: "electivo4", semestre: 4 },
      { nombre: "Electivo Formación General", id: "electivo5", semestre: 4 },

      // Puedes seguir agregando más cursos del 5º al 10º semestre aquí con la misma estructura
    ];

    function crearMalla() {
      const contenedor = document.querySelector('.malla');
      contenedor.innerHTML = '';
      const porSemestre = {};

      cursos.forEach(curso => {
        if (!porSemestre[curso.semestre]) {
          porSemestre[curso.semestre] = [];
        }
        porSemestre[curso.semestre].push(curso);
      });

      Object.keys(porSemestre).sort((a, b) => a - b).forEach(num => {
        const semestreDiv = document.createElement('div');
        semestreDiv.classList.add('semestre');
        semestreDiv.innerHTML = `<h2>${num}° Semestre</h2>`;
        porSemestre[num].forEach(curso => {
          const div = document.createElement('div');
          div.className = 'curso';
          div.id = curso.id;
          div.textContent = curso.nombre;
          if (curso.prereqs) {
            div.classList.add('locked');
            div.dataset.prereqs = curso.prereqs.join(',');
          }
          div.onclick = () => toggle(div);
          semestreDiv.appendChild(div);
        });
        contenedor.appendChild(semestreDiv);
      });

      restaurarProgreso();
      habilitarCursos();
    }

    function toggle(el) {
      if (el.classList.contains('locked')) return;
      el.classList.toggle('aprobado');
      guardarProgreso();
      habilitarCursos();
    }

    function habilitarCursos() {
      document.querySelectorAll('.curso.locked').forEach(curso => {
        const ids = curso.dataset.prereqs?.split(',') || [];
        const habilitado = ids.every(id => document.getElementById(id)?.classList.contains('aprobado'));
        if (habilitado) {
          curso.classList.remove('locked');
        } else {
          curso.classList.add('locked');
          curso.classList.remove('aprobado');
        }
      });
    }

    function guardarProgreso() {
      const ids = [...document.querySelectorAll('.curso.aprobado')].map(el => el.id);
      localStorage.setItem('malla-aprobados', JSON.stringify(ids));
    }

    function restaurarProgreso() {
      const aprobados = JSON.parse(localStorage.getItem('malla-aprobados') || '[]');
      aprobados.forEach(id => {
        const el = document.getElementById(id);
        if (el) el.classList.add('aprobado');
      });
    }

    function alternarVista() {
      const body = document.body;
      if (body.classList.contains('vertical')) {
        body.classList.remove('vertical');
      } else {
        body.classList.add('vertical');
      }
    }

    window.onload = crearMalla;
  </script>
</body>
</html>
